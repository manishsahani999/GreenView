(this.webpackJsonprinit=this.webpackJsonprinit||[]).push([[0],{177:function(e,t,a){e.exports=a(402)},401:function(e,t,a){},402:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(45),r=a.n(o),s=a(19),c=a(171),i=a(28),m=a(29),u=a(31),E=a(30),p=a(32),d=a(33),g=a(13),h=Object(g.a)(),f=a(37),b=a(172),y=a(173),S=a(16),v=a.n(S),O={REGISTER_REQUEST:"USERS_REGISTER_REQUEST",REGISTER_SUCCESS:"USERS_REGISTER_SUCCESS",REGISTER_FAILURE:"USERS_REGISTER_FAILURE",LOGIN_REQUEST:"USERS_LOGIN_REQUEST",LOGIN_SUCCESS:"USERS_LOGIN_SUCCESS",LOGIN_FAILURE:"USERS_LOGIN_FAILURE",LOGOUT:"USERS_LOGOUT",GETALL_REQUEST:"USERS_GETALL_REQUEST",GETALL_SUCCESS:"USERS_GETALL_SUCCESS",GETALL_FAILURE:"USERS_GETALL_FAILURE",DELETE_REQUEST:"USERS_DELETE_REQUEST",DELETE_SUCCESS:"USERS_DELETE_SUCCESS",DELETE_FAILURE:"USERS_DELETE_FAILURE",GET_USER:"GET_USER"},L={UPLOAD_PLANT_IMAGE:"UPLOAD_PLANT_IMAGE",GETALL_PLANT_IMAGES:"GETALL_PLANT_IMAGE"},N=localStorage.getItem("token")?{loggedIn:!0}:{loggedIn:!1};var T=a(46);function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var I={name:""};var U=a(105),G={message:{title:"",value:!1},data:[]};var A=Object(f.c)({authentication:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N;switch((arguments.length>1?arguments[1]:void 0).type){case O.LOGIN_REQUEST:case O.LOGIN_SUCCESS:return{loggedIn:!0};case O.LOGIN_FAILURE:case O.LOGOUT:return{loggedIn:!1};default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.GET_USER:return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(a,!0).forEach((function(t){Object(T.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t.payload);default:return e}},plantImages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L.GETALL_PLANT_IMAGES:return{message:{title:"",value:!1},data:Object(U.a)(t.payload)};case L.UPLOAD_PLANT_IMAGE:return{message:{title:"Created",value:!0},data:[].concat(Object(U.a)(e.data),[t.payload])};default:return e}},loadingBar:S.loadingBarReducer}),j=Object(y.createLogger)(),R=Object(f.d)(A,Object(f.a)(b.a,j,Object(S.loadingBarMiddleware)())),w=a(23),k=a(174),C=a.n(k).a.create({baseURL:"http://localhost:8000/api"}),P=localStorage.getItem("token");console.log(P),P&&(C.defaults.headers.common.Authorization="Bearer ".concat(P));var D=function(e){if(401===e.status){localStorage.removeItem("token");var t=e.data||e.statusText;return Promise.reject(t)}return e.data},M=function(e){return C.post("/login",e).then(D).then((function(e){return localStorage.setItem("token",e.token)}))},F=function(){return localStorage.removeItem("token")},x=function(){return C.post("/me").then(D)},Q=function(e){return C.post("/image",e,{headers:{"content-type":"multipart/form-data"}}).then(D)},B=function(){return C.get("/image").then(D)},H={login:function(e,t){return function(a){var n;a((n={username:e},{type:O.LOGIN_REQUEST,user:n})),a(Object(S.showLoading)()),M(e,t).then((function(e){a(function(e){return{type:O.LOGIN_SUCCESS,user:e}}(e)),setTimeout((function(){a(Object(S.hideLoading)())}),1e3)}),(function(e){a(function(e){return{type:O.LOGIN_FAILURE,err:e}}(e.toString())),console.log("Error in Actions/UserActions/Login"),console.log(e),a(Object(S.hideLoading)())}))}},logout:function(){return F(),{type:O.LOGOUT}},getUser:function(){return function(e){x().then((function(t){return e({type:O.GET_USER,payload:t}),{type:O.GET_USER,payload:t}}),(function(e){console.log("Failure in getUser"),console.log(e)}))}}},z={uploadPlantImage:function(e){return function(t){Q(e).then((function(e){return t(Object(S.showLoading)()),t({type:L.UPLOAD_PLANT_IMAGE,payload:e}),setTimeout((function(){t(Object(S.hideLoading)())}),1e3),{type:L.UPLOAD_PLANT_IMAGE,payload:e}}))}},getAllPlantImages:function(){return function(e){B().then((function(t){return e({type:L.GETALL_PLANT_IMAGES,payload:t}),{type:L.GETALL_PLANT_IMAGES,payload:t}}))}}},W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(E.a)(t).call(this,e))).handleChange=function(e){return a.setState(Object(T.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),console.log("Login form Submitted with",a.state.email),a.props.login(a.state)},a.state={email:"manishsahani@gmail.com",password:"manish"},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return console.log(this.props),localStorage&&localStorage.getItem("token")?l.a.createElement(d.a,{to:"/dashboard"}):l.a.createElement("div",null,l.a.createElement("section",{className:"hero is-fullheight"},l.a.createElement("div",{className:"hero-body"},l.a.createElement("div",{className:"container"},l.a.createElement("h1",{className:"title"},"Login"),l.a.createElement("div",{className:"columns"},l.a.createElement("div",{className:"column is-half"},l.a.createElement("form",{action:"",onSubmit:this.handleSubmit,className:"column is-3by4",style:{padding:0}},l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control has-icons-left"},l.a.createElement("input",{onChange:this.handleChange,value:this.state.email,className:"input",name:"email",type:"text",placeholder:"Enter Email"}),l.a.createElement("span",{className:"icon is-small is-left"},l.a.createElement("i",{className:"fas fa-user"})))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control has-icons-left"},l.a.createElement("input",{onChange:this.handleChange,value:this.state.password,className:"input",name:"password",type:"password",placeholder:"Enter password"}),l.a.createElement("span",{className:"icon is-small is-left"},l.a.createElement("i",{className:"fas fa-lock"})))),l.a.createElement("div",{className:"field"},l.a.createElement("button",{type:"submit",className:"button is-primary is-fullwidth"},"Submit"))))),l.a.createElement("h2",{className:"subtitle"},l.a.createElement(w.a,{to:"/"},"Home"))))))}}]),t}(l.a.Component),J={login:H.login},Y=Object(s.connect)((function(e){return{auth:e}}),J)(W),q=Object(s.connect)((function(e){return{auth:e.authentication}}),{})((function(e){console.log("Home Component"),console.log(e);var t=e.auth.loggedIn;return console.log(t),l.a.createElement("section",{className:"hero is-fullheight"},l.a.createElement("div",{className:"hero-body"},l.a.createElement("div",{className:"container"},l.a.createElement("h1",{className:"title is-size-1"},"GREENVIEW"),t&&l.a.createElement("h2",{className:"subtitle"},l.a.createElement(w.a,{to:"/dashboard"},"Dashboard")),!t&&l.a.createElement("h2",{className:"subtitle"},l.a.createElement(w.a,{to:"/login"},"Framers Login")))))})),K=a(77),V=a(48),Z=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return this.props.isGeolocationAvailable?this.props.isGeolocationEnabled?this.props.coords?l.a.createElement("div",null,l.a.createElement("h1",{className:"subtitle",style:{marginBottom:".5rem"}},"You are Here"),l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"latitude"),l.a.createElement("td",null,this.props.coords.latitude)),l.a.createElement("tr",null,l.a.createElement("td",null,"longitude"),l.a.createElement("td",null,this.props.coords.longitude))))):l.a.createElement("div",null,"Getting the location data\u2026 "):l.a.createElement("div",null,"Geolocation is not enabled"):l.a.createElement("div",null,"Your browser does not support Geolocation")}}]),t}(l.a.Component),$=Object(K.geolocated)({positionOptions:{enableHighAccuracy:!1},userDecisionTimeout:5e3})(Z),X=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(E.a)(t).call(this,e))).handleChange=function(e){return a.setState(Object(T.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t=new FormData;t.append("image",a.fileInput.current.files[0]),t.append("lat",a.props.coords.latitude),t.append("lng",a.props.coords.longitude),a.props.uploadPlantImage(t)},a.state={loadingBarProgress:0},a.fileInput=l.a.createRef(),a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){this.props.me(),this.props.getAllPlantImages()}},{key:"componentDidMount",value:function(){this.props.message.val&&console.log("clear")}},{key:"render",value:function(){var e=this;if(!this.props.isGeolocationAvailable||!this.props.isGeolocationEnabled)return l.a.createElement(ee,this.props);var t={latitude:28.629401599999998,longitude:77.160448},a=this.props,n=a.user,o=a.markers;return this.props.coords&&(t=this.props.coords),l.a.createElement("div",null,this.props.message.val&&this.props.message.title,l.a.createElement("div",{className:"columns"},l.a.createElement("div",{className:"column is-one-quarter p-1"},l.a.createElement("h1",{className:"title is-size-1"},l.a.createElement(w.a,{className:"has-text-primary",to:"/"},"Farmer")),l.a.createElement("h1",{className:"subtitle",style:{textTransform:"capitalize"}},n.name),l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){return e.props.logout()},className:"button is-link"},"Logout")),l.a.createElement("br",null),l.a.createElement($,null),l.a.createElement("form",{onSubmit:this.handleSubmit},l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"file has-name is-boxed is-fullwidth",style:{marginTop:"4rem"}},l.a.createElement("label",{className:"file-label"},l.a.createElement("input",{ref:this.fileInput,className:"file-input",type:"file",name:"plantimg"}),l.a.createElement("span",{className:"file-cta"},l.a.createElement("span",{className:"file-icon"},l.a.createElement("i",{className:"fas fa-upload"})),l.a.createElement("span",{className:"file-label"},"Upload a Picture")),l.a.createElement("span",{className:"file-name"})))),l.a.createElement("div",{className:"field"},l.a.createElement("button",{onClick:this.showLoader,className:"button is-primary is-fullwidth"},"Submit")))),l.a.createElement("div",{className:"column"},l.a.createElement("div",{className:"",style:{width:"100%",height:"100vh"}},l.a.createElement(oe,{googleMapURL:"https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places&key=AIzaSyCFmHR_8osaHWKMr7_8NAySPUQSWLutFeE",loadingElement:l.a.createElement("div",{style:{height:"100%"}}),containerElement:l.a.createElement("div",{style:{height:"100%"}}),mapElement:l.a.createElement("div",{style:{height:"100%"}}),coords:t,markers:o})))))}}]),t}(l.a.Component),ee=function(e){return l.a.createElement("section",{className:"hero is-fullheight"},l.a.createElement("div",{className:"hero-body"},l.a.createElement("div",{className:"container"},l.a.createElement("img",{style:{width:"8em",marginBottom:"1rem"},src:"https://image.flaticon.com/icons/svg/356/356761.svg",alt:""}),l.a.createElement("h1",{className:"title is-size-2"},"Geolocation is Not Enabled"),l.a.createElement("h2",{className:"subtitle"},l.a.createElement(w.a,{to:"/"},"Go back to Home")),e.auth.loggedIn&&l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){return e.logout()},className:"button is-link"},"Logout")))))},te={logout:H.logout,me:H.getUser,uploadPlantImage:z.uploadPlantImage,getAllPlantImages:z.getAllPlantImages},ae=Object(s.connect)((function(e){return{auth:e.authentication,user:e.user,markers:e.plantImages.data,message:e.plantImages.message}}),te)(X),ne=Object(K.geolocated)({positionOptions:{enableHighAccuracy:!0},userDecisionTimeout:5e3})(ae),le=function(e){var t=e.markers;return t?t.map((function(e){return l.a.createElement(V.Marker,{label:e.disease_name,key:e.id+Math.floor(1e5*Math.random()+1),position:{lat:parseFloat(e.lat),lng:parseFloat(e.lng)}})})):l.a.createElement("div",null)},oe=Object(V.withScriptjs)(Object(V.withGoogleMap)((function(e){return l.a.createElement(V.GoogleMap,{defaultZoom:17,defaultCenter:{lat:e.coords.latitude,lng:e.coords.longitude},defaultOptions:{styles:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"all",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}]}},l.a.createElement(le,{markers:e.markers}),l.a.createElement(V.Marker,{label:"",icon:{url:"https://cdn.pixabay.com/photo/2014/04/03/10/03/google-309740_960_720.png",scaledSize:{width:32,height:62}},position:{lat:e.coords.latitude,lng:e.coords.longitude}}))}))),re=(a(401),function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(v.a,{style:{backgroundColor:"#f11946",height:"5px"}}),l.a.createElement(d.c,{history:h},l.a.createElement(d.d,null,l.a.createElement(d.b,{exact:!0,path:"/"},l.a.createElement(q,this.props)),l.a.createElement(d.b,{path:"/login",component:Y}),l.a.createElement(se,{path:"/dashboard",component:ne}))))}}]),t}(l.a.Component)),se=function(e){var t=e.component,a=Object(c.a)(e,["component"]);return l.a.createElement(d.b,Object.assign({},a,{render:function(e){return localStorage.getItem("token")?l.a.createElement(t,e):l.a.createElement(d.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},ce=Object(s.connect)((function(e){return{auth:e.authentication}}),{})(re);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(s.Provider,{store:R},l.a.createElement(ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[177,1,2]]]);
//# sourceMappingURL=main.ee3cac35.chunk.js.map